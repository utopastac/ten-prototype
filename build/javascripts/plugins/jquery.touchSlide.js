!function(t){function e(e,s){this.element=t(e),this.defaults={speedThreshold:500,firstTouchThreshold:0,speed:.35,resistance:.5,selector:".slide",drag:!1,touch:!0,navSelector:"",prevArrowSelector:"",nextArrowSelector:"",useKeyboard:!0,autoplay:!1,autoplayDuration:4,pauseOnClick:!0,vertical:!1,mouseWheel:!1,scrollThreshold:1,pageRatio:1,rotateOnDrag:1,createNavigation:{create:!1,wrapper:{open:"",close:""},navigationItem:"",navSelector:""}};var n=this.element.data("touch-slide");this.options=t.extend({},this.defaults,s,n),this.element.data(i,this),this.pagePanel=this.element,this.innerPageSize=100,this.settingUp=!0,this.animating=!1,this.currentIndex=0,this.pages=t(this.options.selector,this.element),this.totalPages=this.pages.length-1,this.stepTouch={first:!0,second:!0},this.pageSize=0,this.points=[],this.paused=!1,this.autoTween=null,this.moveValue=1,this.wrapperElement=this.element.parent(),this.element.imagesLoaded(jQuery.proxy(this,"init"))}var i="plugin-touch-slide";e.prototype={init:function(){t(window).resize(jQuery.proxy(this,"resized")),this.resized(),this.options.touch&&this.initTouch(),this.options.drag&&this.initDrag(),this.options.navSelector.length>1&&this.addNavigation(),this.options.mouseWheel&&this.addMouseWheel(),this.options.createNavigation.create&&this.createNavigation(),this.options.useKeyboard&&t(document).keyup(jQuery.proxy(this,"keyboardUp")),this.addArrowNavigation(),this.addActiveClasses(this.currentIndex)},resized:function(){this.options.vertical?(this.pageSize=this.wrapperElement.outerHeight(),this.element.css({height:this.pageSize*(this.totalPages+1)}),this.pages.css({height:this.pageSize}),this.pages.each(jQuery.proxy(this,"alignPages"))):(this.pageSize=this.wrapperElement.outerWidth(),this.innerPageSize=this.wrapperElement.outerWidth()*this.options.pageRatio,this.pageSizeOffset=(this.pageSize-this.innerPageSize)/2,this.element.css({width:this.innerPageSize*(this.totalPages+1)}),this.pages.css({width:this.innerPageSize}),this.pages.each(jQuery.proxy(this,"alignPages"))),this.animating||this.resetToPosition(!0)},alignPages:function(t){this.options.vertical?this.pages.eq(t).css({top:this.innerPageSize*t}):this.pages.eq(t).css({left:this.pageSizeOffset+this.innerPageSize*t});var e=jQuery.Event("alignPages");e.currentIndex=this.currentIndex,this.element.trigger(e)},addNavigation:function(){this.nav=t(this.options.navSelector),this.nav.on("tap",jQuery.proxy(this,"navClicked"))},createNavigation:function(){for(var e=this.options.createNavigation.wrapper.open,i=0;i<this.pages.length;i++)e+=this.options.createNavigation.navigationItem;e+=this.options.createNavigation.wrapper.close,this.wrapperElement.append(e),this.nav=t(this.options.createNavigation.navSelector),this.nav.click(jQuery.proxy(this,"navClicked"))},addArrowNavigation:function(){this.options.nextArrowSelector.length>1&&(this.nextArrow=t(this.options.nextArrowSelector).on("tap",jQuery.proxy(this,"nextArrowClicked"))),this.options.prevArrowSelector.length>1&&(this.prevArrow=t(this.options.prevArrowSelector).on("tap",jQuery.proxy(this,"prevArrowClicked")))},keyboardUp:function(t){switch(t.keyCode){case 39:this.options.vertical||this.moveDirection(1);break;case 37:this.options.vertical||this.moveDirection(-1);break;case 38:this.options.vertical&&this.moveDirection(-1);break;case 40:this.options.vertical&&this.moveDirection(1)}},addMouseWheel:function(){t.window.on("wheel mousewheel",jQuery.proxy(this,"mouseWheeled"))},mouseWheeled:function(t){if(!this.animating){var e=t.originalEvent.wheelDeltaY||-t.originalEvent.deltaY;0>e?this.moveDirection(1):e>0&&this.moveDirection(-1)}},initTouch:function(){this.setupMoving(),this.pagePanel.bind("touchstart",jQuery.proxy(this,"firstTouch"))},firstTouch:function(t){TweenLite.killTweensOf(this.element),this.stopAnimating(),this.animating||(this.resetMoveObject(t.originalEvent.changedTouches[0]),this.pagePanel.bind("touchmove",jQuery.proxy(this,"touchMoved")),this.pagePanel.bind("touchend",jQuery.proxy(this,"touchEnded")))},touchMoved:function(t){if(this.updateMoveObject(t.originalEvent.changedTouches[0]),!this.checkThreshold())return!0;this.getMoving(t)},touchEnded:function(t){this.pagePanel.unbind("touchmove",jQuery.proxy(this,"touchMoved")),this.checkEnd(t.originalEvent.changedTouches[0]),this.pagePanel.unbind("touchend",jQuery.proxy(this,"touchEnded"))},initDrag:function(){this.setupMoving(),this.pagePanel.bind("mousedown",jQuery.proxy(this,"firstDrag"))},firstDrag:function(e){this.animating||(this.resetMoveObject(e),this.pagePanel.bind("mousemove",jQuery.proxy(this,"dragMoved")),t.window.bind("mouseup",jQuery.proxy(this,"dragEnded")))},dragMoved:function(t){if(this.updateMoveObject(t),!this.checkThreshold())return!0;this.getMoving(t)},dragEnded:function(e){this.pagePanel.unbind("mousemove",jQuery.proxy(this,"dragMoved")),this.checkEnd(e),t.window.unbind("mouseup",jQuery.proxy(this,"dragEnded"))},setupMoving:function(){this.moveObject={start:{x:0,y:0},current:{x:0,y:0},end:{x:0,y:0},change:0}},savePoint:function(){var t=new Date,e={x:this.moveObject.current.x,y:this.moveObject.current.y,time:t.getTime()};this.points.push(e),this.points.length>20&&this.points.shift()},resetMoveObject:function(t){this.stepTouch={first:!0,second:!0},this.moveObject.originalPosition=this.element.position(),this.moveObject.start.x=t.pageX,this.moveObject.start.y=t.pageY,this.updateMoveObject(t),this.time=0,this.time=new Date,this.points=[]},updateMoveObject:function(t){this.options.vertical?this.moveObject.change=t.pageY-this.moveObject.start.y:this.moveObject.change=t.pageX-this.moveObject.start.x,this.moveObject.current.x=t.pageX,this.moveObject.current.y=t.pageY,this.savePoint()},checkThreshold:function(){return!this.stepTouch.second||(this.stepTouch.first?(this.stepTouch.first=!1,!1):Math.abs(this.moveObject.start.x-this.moveObject.current.x)<Math.abs(this.moveObject.start.y-this.moveObject.current.y)&&!this.options.vertical?(this.unBindEvents(),!1):Math.abs(this.moveObject.start.y-this.moveObject.current.y)<Math.abs(this.moveObject.start.x-this.moveObject.current.x)&&this.options.vertical?(this.unBindEvents(),!1):Math.abs(this.moveObject.change)<this.options.firstTouchThreshold&&this.stepTouch.second?(this.unBindEvents(),!1):(this.stepTouch.second=!1,!0))},unBindEvents:function(){this.pagePanel.unbind("touchmove",jQuery.proxy(this,"touchMoved")),this.pagePanel.unbind("touchend",jQuery.proxy(this,"touchEnded")),this.pagePanel.unbind("mousemove",jQuery.proxy(this,"dragMoved")),t.window.unbind("mouseup",jQuery.proxy(this,"dragEnded"))},getMoving:function(t){if(this.options.vertical)var e=this.moveObject.current.y-this.moveObject.start.y;else var e=this.moveObject.current.x-this.moveObject.start.x;(0==this.currentIndex&&e>0||this.currentIndex==this.totalPages&&e<0)&&(this.moveObject.change*=this.options.resistance);var i=this.options.vertical?this.moveObject.originalPosition.top:this.moveObject.originalPosition.left,s=i+this.moveObject.change;t.preventDefault(),this.moveScrolled(s),this.time++},checkEnd:function(t){this.savePoint(),this.element.removeClass("stopSelection");var e=this.points[Math.max(0,this.points.length-3)],i=this.points[this.points.length-1],s=this.points[0];if(this.moveObject.end.x=t.pageX,this.moveObject.end.y=t.pageY,this.options.vertical)var n=this.moveObject.end.y-this.moveObject.start.y,o=Math.abs(i.y-s.y),a=Math.abs(i.y-e.y)>0?i.y-e.y:n;else var n=this.moveObject.end.x-this.moveObject.start.x,o=Math.abs(i.x-s.x),a=Math.abs(i.x-e.x)>0?i.x-e.x:n;var h=a>=0?-1:1,r=(i.time-s.time)/1e3,c=Math.max(1,Math.floor(o/r));if(0==this.currentIndex&&n>0||this.currentIndex==this.totalPages&&n<0)this.resetToPosition();else if(Math.abs(n)>=this.innerPageSize/2||c>=this.options.speedThreshold){this.startAnimating();var u=Math.max(.15,Math.min(.35,500/c));this.moveTouchDirection(h,u)}else this.resetToPosition()},moveScrolled:function(t){this.moveValue=t,this.animateElement(this.element,t,0,function(){},Linear.easeNone)},resetToPosition:function(t){this.startAnimating();var e=t?0:this.options.speed+.05;this.animateElement(this.element,this.innerPageSize*-this.currentIndex,e,jQuery.proxy(this,"stopAnimating"),Power2.easeOut)},moveTouchDirection:function(t,e){var i=Math.max(0,Math.min(this.currentIndex+t,this.totalPages));this.movingAdmin(i,e)},stopAnimating:function(){this.animating=!1,this.settingUp&&(this.settingUp=!1,this.element.trigger("setupComplete"))},startAnimating:function(){this.animating=!0},moveToPage:function(t,e){t!=this.currentIndex&&this.movingAdmin(t,e)},movingAdmin:function(t,e){this.startAnimating(),this.currentIndex=t,this.addActiveClasses(t);var i=e||this.options.speed;this.animateElement(this.element,this.innerPageSize*-t,i,jQuery.proxy(this,"pageArrived")),this.element.trigger("startMove",this.currentIndex);var s=jQuery.Event("onTheMove");s.currentIndex=this.currentIndex,this.element.trigger(s)},addActiveClasses:function(e){if(this.pages.removeClass("active"),this.pages.eq(e).addClass("active"),this.nav&&(this.nav.removeClass("active"),this.nav.eq(e).addClass("active")),this.prevArrow&&(this.prevArrow.removeClass("active"),this.nextArrow.removeClass("active"),0==e&&this.prevArrow.addClass("active"),e==this.totalPages&&this.nextArrow.addClass("active")),this.options.autoplay){null!=this.autoTween&&this.autoTween.kill(),t("span",this.nav).css({width:0});var i=t("span",this.nav.eq(this.currentIndex));this.autoTween=TweenMax.to(i,this.options.autoplayDuration,{css:{width:"100%"},onComplete:jQuery.proxy(this,"autoNext"),ease:Linear.easeNone}),this.paused&&this.autoTween.pause()}},pageArrived:function(){this.stopAnimating(),this.element.trigger("pageInPlace",this.currentIndex)},autoNext:function(){var t=this.currentIndex+1>this.totalPages?0:this.currentIndex+1;this.moveToPage(t)},navClicked:function(e){var i=Utils.getElementIndex(t(e.currentTarget));this.gotoPage(i)},prevArrowClicked:function(){this.moveDirection(-1)},nextArrowClicked:function(){this.moveDirection(1)},gotoPage:function(t){this.options.pauseOnClick&&(this.paused=!0),this.moveToPage(t)},moveDirection:function(t){this.options.pauseOnClick&&(this.paused=!0);var e=Math.max(0,Math.min(this.currentIndex+t,this.totalPages));this.moveToPage(e)},animateElement:function(e,i,s,n,o){var a=o||Power2.easeOut,h=t.useCssAnim?{x:i}:{left:i};this.options.vertical&&(h=t.useCssAnim?{y:i}:{top:i}),TweenMax.to(e,s,{css:h,onComplete:n,ease:a,onUpdate:jQuery.proxy(this,"elementAnimating")})},elementAnimating:function(){var t=jQuery.Event("animating");t.currentIndex=this.currentIndex,t.moveValue=this.moveValue,t.innerPageSize=this.innerPageSize,t.pageSizeOffset=this.pageSizeOffset,this.element.trigger(t)}},t.fn.touchSlide=function(t){return this.each(function(){new e(this,t)})}}(jQuery),$(function(){$("[data-touch-slide]").touchSlide()});